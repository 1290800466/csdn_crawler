<!DOCTYPE html>
            <html>
              <head>
                <meta http-equiv="content-type" content="text/html; charset=utf-8">
                <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
                <meta name="apple-mobile-web-app-status-bar-style" content="black">

                <meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />

                <title></title>
              </head>
              <body><div class="skin_detail" id="article_content">&#13;
                        <div class="markdown_views"><pre class="prettyprint"><code class=" hljs xml"><span class="php"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-comment">/**
 * 高效率计算文件行数
 *<span class="hljs-phpdoc"> @param</span> unknown $file
 *<span class="hljs-phpdoc"> @return</span> number
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">count_line</span><span class="hljs-params">(<span class="hljs-variable">$file</span>)</span> {</span>
    <span class="hljs-variable">$fp</span>=fopen(<span class="hljs-variable">$file</span>, <span class="hljs-string">"r"</span>);
    <span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span>(!feof(<span class="hljs-variable">$fp</span>)) {
        <span class="hljs-comment">//每次读取2M</span>
        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$data</span>=fread(<span class="hljs-variable">$fp</span>,<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">2</span>)){
            <span class="hljs-comment">//计算读取到的行数</span>
            <span class="hljs-variable">$num</span>=substr_count(<span class="hljs-variable">$data</span>,<span class="hljs-string">"\n"</span>);
            <span class="hljs-variable">$i</span>+=<span class="hljs-variable">$num</span>;
        }
    }
    fclose(<span class="hljs-variable">$fp</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$i</span>;
}</span></code></pre></div><link rel="stylesheet" href="http://static.blog.csdn.net/public/res-min/markdown_views.css?v=1.0"/></div>  </body>
            </html>