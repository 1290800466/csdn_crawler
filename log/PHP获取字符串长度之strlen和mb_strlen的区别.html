<!DOCTYPE html>
            <html>
              <head>
                <meta http-equiv="content-type" content="text/html; charset=utf-8">
                <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
                <meta name="apple-mobile-web-app-status-bar-style" content="black">

                <meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />

                <title></title>
              </head>
              <body><div class="skin_detail" id="article_content">&#13;
                        &#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
在<span style="text-align:center">PHP</span>中，<span style="text-align:center">strlen</span>与<span style="text-align:center">mb_strlen</span>是求字符串长度的函数，但是对于一些初学者来说，如果不看手册，也许不太清楚其中的区别。<br style="clear:both; width:0px; height:0px"/>&#13;
下面通过例子，讲解这两者之间的区别。</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
先看例子：</p>&#13;
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; color:rgb(51,51,51); font-family:'Courier New',monospace; width:591.016px; overflow:auto; line-height:28px; background:rgb(230,230,230)"><ol class="dp-c" style="margin-left:55px; padding:5px 0px; color:rgb(92,92,92); word-wrap:break-word; word-break:normal; border:none; margin-top:0px!important; margin-right:0px!important; margin-bottom:1px!important; background:rgb(247,247,247)"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&lt;?php  </span></li><li style="list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//测试时文件的编码方式要是UTF8 </span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> </span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px"><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">=</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'中文a字1符'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">;  </span></li><li style="list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span class="func" style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">echo</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> </span><span class="func" style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">strlen</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">(</span><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">).</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'&lt;br&gt;'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">;</span><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//14 </span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> </span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px"><span class="func" style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">echo</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> mb_strlen(</span><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">,</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'utf8'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">).</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'&lt;br&gt;'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">;</span><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//6 </span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> </span></li><li style="list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span class="func" style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">echo</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> mb_strlen(</span><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">,</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'gbk'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">).</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'&lt;br&gt;'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">;</span><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//8 </span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> </span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px"><span class="func" style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">echo</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> mb_strlen(</span><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">,</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'gb2312'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">).</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'&lt;br&gt;'</span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">;</span><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//10 </span><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"> </span></li><li style="list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">?&gt; </span></li></ol></pre>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
结果分析：在strlen计算时，对待一个UTF8的中文字符是3个长度，所以“中文a字1符”长度是3*4+2=14,在mb_strlen计算时，选定内码为UTF8，则会将一个中文字符当作长度1来计算，所以“中文a字1符”长度是6 .</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
利用这两个函数则可以联合计算出一个中英文混排的串的占位是多少（一个中文字符的占位是2，英文字符是1）</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
</p>&#13;
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; color:rgb(51,51,51); font-family:'Courier New',monospace; width:591.016px; overflow:auto; line-height:28px; background:rgb(230,230,230)"><ol class="dp-c" style="margin-left:55px; padding:5px 0px; color:rgb(92,92,92); word-wrap:break-word; word-break:normal; border:none; margin-top:0px!important; margin-right:0px!important; margin-bottom:1px!important; background:rgb(247,247,247)"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="func" style="margin:0px; padding:0px; border:none; background-color:inherit">echo</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (</span><span class="func" style="margin:0px; padding:0px; border:none; background-color:inherit">strlen</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">(</span><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">) + mb_strlen(</span><span class="vars" style="margin:0px; padding:0px; border:none; color:rgb(221,0,0); background-color:inherit">$str</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'UTF8'</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)) / 2; </span></span></li></ol></pre>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
例如 “中文a字1符” 的strlen($str)值是14，mb_strlen($str)值是6，则可以计算出“中文a字1符”的占位是10.</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
</p>&#13;
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; color:rgb(51,51,51); font-family:'Courier New',monospace; width:591.016px; overflow:auto; line-height:28px; background:rgb(230,230,230)"><ol class="dp-c" style="margin-left:55px; padding:5px 0px; color:rgb(92,92,92); word-wrap:break-word; word-break:normal; border:none; margin-top:0px!important; margin-right:0px!important; margin-bottom:1px!important; background:rgb(247,247,247)"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; color:inherit; list-style:decimal outside none; word-wrap:break-word; word-break:normal; border:none; line-height:18px"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="func" style="margin:0px; padding:0px; border:none; background-color:inherit">echo</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> mb_internal_encoding(); </span></span></li></ol></pre>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
PHP内置的字符串长度函数strlen无法正确处理中文字符串，它得 到的只是字符串所占的字节数。对于GB2312的中文编码，strlen得到的值是汉字个数的2倍，而对于UTF-8编码的中文，就是3倍的差异了（在 UTF-8编码下，一个汉字占3个字节）。</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
采用mb_strlen函数可以较好地解决这个问题。mb_strlen的用法和 strlen类似，只不过它有第二个可选参数用于指定字符编码。例如得到UTF-8的字符串$str长度，可以用 mb_strlen($str,'UTF-8')。如果省略第二个参数，则会使用PHP的内部编码。内部编码可以通过 mb_internal_encoding()函数得到。</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
需要注意的是，mb_strlen并不是PHP核心函数，使用前需要确保在php.ini中加载了php_mbstring.dll，即确保“extension=php_mbstring.dll”这一行存在并且没有被注释掉，否则会出现未定义函 数的问题。</p>&#13;
<p style="margin-top:10px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); text-indent:28px; font-family:宋体; font-size:14px; line-height:28px; background-color:rgb(248,248,248)">&#13;
转自：<a target="_blank" href="http://developer.51cto.com/art/201105/263103.htm">http://developer.51cto.com/art/201105/263103.htm</a></p>&#13;
&#13;
                      </div>  </body>
            </html>